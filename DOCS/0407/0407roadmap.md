# 土地図からの一軒家CAD図自動生成システム 技術実証（PoC）開発ロードマップ
## 2024年4月8日～2024年7月15日

## フェーズ1: 環境構築・基盤開発と初期クラウド統合（4月8日～5月5日）
### 週1-2（4/8～4/21）：プロジェクト準備と環境セットアップ
- [ ] 技術実証の詳細計画確定と成功基準の設定
- [ ] Google Cloudプロジェクトのセットアップ
  - GCPプロジェクト作成と基本設定
  - 必要なAPIの有効化（Cloud Storage, Cloud Run, Vertex AI等）
  - IAM権限の初期設定
- [ ] **Google Drive/Forms連携の構築**
  - 既存のGoogle Form/Driveからのデータ取得方法の分析
  - Google Cloud環境へのデータ連携方法の設計
  - APIアクセス権限の設定
- [ ] 開発環境のセットアップ
- [ ] **FreeCADのDockerコンテナ化調査と初期実験**（★技術的難易度高）
  - FreeCADヘッドレスモードの実行可能性検証
  - 基本的なPython APIの調査と簡易テスト

### 週3-4（4/22～5/5）：フロントエンド初期実装とFreeCAD基盤
- [ ] 既存Streamlitアプリへの新機能追加準備
  - CAD生成に必要なUI要素の設計
  - 既存コードとの連携ポイント特定
- [ ] **Google Drive連携モジュールの実装**
  - Google Drive APIを使用したファイル取得機能
  - データセット管理のための自動化スクリプト
  - Forms-Drive-GCPの連携フロー構築
- [ ] Cloud Runへの初期デプロイ
  - CI/CDパイプラインの構築
  - 自動ビルド・デプロイの設定
- [ ] **FreeCADのDockerコンテナ化と基本動作検証**（継続）
  - コンテナ内での安定動作確認
  - 基本的なPython API呼び出しのテスト
  - クラウド環境での動作確認

## フェーズ2: コア機能開発第一段階（5月6日～5月26日）
### 週5-6（5/6～5/19）：土地解析データ活用とFreeCAD連携
- [ ] 既存YOLO11出力データの分析と拡張活用
  - 既存セグメンテーション結果からCAD生成に必要なデータの抽出
  - 建築可能エリア計算への応用
- [ ] **Google Forms/Driveデータの統合と活用**
  - データセットの自動インポート機能
  - メタデータと画像データの関連付け
  - データの前処理パイプライン構築
- [ ] **FreeCAD連携モジュールの基本実装**（★技術的難易度高）
  - シンプルな形状生成スクリプトの作成
  - FreeCADとPython間の通信確立
  - 初期テストケースの実行

### 週7（5/20～5/26）：GCPサービス連携とストレージ実装
- [ ] Cloud Storageとの接続設定
  - 入力画像の保存
  - 生成CADファイルの保存と取得
- [ ] **Google DriveとCloud Storageの同期機能**
  - 定期的なデータ同期の仕組み
  - 大規模データセットの効率的な転送方法
- [ ] GCPサービス間の連携テスト
  - ストレージ→処理→ストレージのデータフロー確認
  - 初期パフォーマンス評価
- [ ] テスト用土地データセットの準備と検証
- [ ] Cloud Run上での定期的な統合テスト確立

## フェーズ3: コア機能開発第二段階（5月27日～6月16日）
### 週8-9（5/27～6/9）：建物形状生成エンジン開発
- [ ] 既存のセグメンテーションからCAD用建物外形への変換
  - セグメント外形から正確な建物境界線の抽出
  - CAD形式に適した形状データへの変換
- [ ] 建蔽率・容積率の計算機能
- [ ] テストケースの拡充と単体テスト
- [ ] **FreeCAD連携モジュールの拡張**（継続）
  - 建物外形のCAD描画機能
  - 基本的な図面要素の追加
- [ ] **データセット管理システムの強化**
  - データセットの質の評価と改善
  - 追加データの取り込みフロー整備

### 週10（6/10～6/16）：既存間取り生成機能とCAD連携
- [ ] 既存の間取り生成ロジックとFreeCADの連携
  - 間取りデータからCAD描画命令への変換
  - 壁・開口部の描画ロジック
- [ ] Streamlit UIの機能拡張
  - CAD生成パラメータ調整UIの追加
  - 生成プロセス表示の改善
- [ ] **Google Formsからのフィードバック収集機能**
  - ユーザーフィードバックの自動収集と分析
  - 改善点の特定と優先順位付け

## フェーズ4: CAD図面生成とシステム統合（6月17日～7月7日）
### 週11-12（6/17～6/30）：CAD図面生成実装
- [ ] **FreeCADスクリプトテンプレートの作成**（★技術的難易度高）
  - 基本的な壁・開口部の描画機能
  - 部屋ラベル・寸法線の基本表示機能
- [ ] CADデータ変換モジュール（FreeCAD→DXF/DWG）
- [ ] クラウド上でのFreeCAD処理の最適化
  - メモリ使用量の監視と調整
  - 処理時間の計測と改善
- [ ] GCPでのパフォーマンスモニタリング設定
  - Cloud Monitoring ダッシュボード構築
  - アラート設定
- [ ] **Google DriveへのCAD図面自動保存機能**
  - 生成結果の整理・分類
  - ユーザーアクセス権管理

### 週13（7/1～7/7）：コンポーネント統合と初期テスト
- [ ] 土地解析→建物形状生成→間取り生成→CAD出力の一連の流れ統合
- [ ] エラーハンドリングとログ機能の実装
- [ ] システム統合テストとバグ修正
- [ ] Cloud Runインスタンスのスケーリング設定調整
  - 負荷テストの実施
  - リソース割り当ての最適化
- [ ] **エンドツーエンドワークフローの検証**
  - Google Forms入力→処理→Drive出力の完全フロー
  - エラーケースの特定と対応

## フェーズ5: 技術実証完了と評価（7月8日～7月15日）
### 週14（7/8～7/15）：技術実証の評価と文書化
- [ ] CAD図面生成機能の最終調整
- [ ] 技術実証の総合評価
  - 実現可能性の検証結果まとめ
  - パフォーマンスと品質の評価
  - 技術的制約と解決策の文書化
- [ ] デモ用システムの安定化
- [ ] **データフロー全体の最適化**
  - Google Forms/Drive→GCP→CAD→Drive の完全サイクル
  - ボトルネックの特定と改善
- [ ] 将来の本格実装に向けた提言書作成
  - スケールアップのためのアーキテクチャ提案
  - 必要なリソースと開発期間の見積もり
  - リスクと緩和策

## 技術実証の重点領域
### 優先すべき検証項目
1. **FreeCADのクラウド環境での実用性**：最も大きな技術的リスク要素
2. **既存YOLO11システムとFreeCADの統合可能性**：核心的な検証ポイント
3. **CAD図面生成の自動化レベル**：どの程度の品質でCAD図が自動生成できるか
4. **Google Forms/Drive連携の効率性**：データ収集から結果出力までの一貫した流れ
5. **GCP環境でのパフォーマンスと安定性**：スケーラブルなシステムとして機能するか

### 削減可能な検証範囲（時間制約の場合）
1. **複雑な建築法規制の実装**：基本的な建蔽率・道路斜線のみで技術実証
2. **高度な間取り最適化**：既存システムの間取り生成機能を最大限活用
3. **詳細なCAD図面の装飾**：基本的な壁・開口部のみで技術的実現性を証明
4. **Google Driveの高度な権限管理**：基本的なアクセス制御のみを実装
5. **多様なケースでの検証**：代表的な2-3パターンの土地図で技術実証を完了

## 開発進捗管理
* 週次のスプリントで計画と振り返りを実施
* 高難度タスク（特にFreeCAD関連）の早期開始と継続的な取り組み
* Cloud Run環境への定期的デプロイを通じた進捗の可視化
* 主要な技術的ハードルごとの検証結果の文書化
* Google Sheetsを活用した進捗追跡とタスク管理

## リスク管理
### 主要リスクと対策
1. **FreeCADのクラウド環境での安定性と性能**（★最大のリスク）
   * 対策：フェーズ1から取り組み開始し、十分な検証期間を確保
   * 代替案：技術実証の結果次第では、別のCADライブラリの検討も視野に

2. **Google Drive API制限とパフォーマンス**
   * 対策：API呼び出し頻度の最適化、バッチ処理の実装
   * 代替案：データキャッシュの活用、必要に応じてCloud Storageへの完全移行

3. **処理時間の長さとクラウドコスト**
   * 対策：非同期処理の実装、処理の分割と最適化
   * 代替案：技術実証段階では処理時間より機能の実現性を優先

4. **チーム規模（2名）に対するタスク量**
   * 対策：技術実証の範囲を明確に絞り込み、核心的な検証項目に集中
   * 代替案：外部サービスやライブラリの活用で自前実装を減らす

5. **既存システムと新機能の統合の複雑さ**
   * 対策：明確な接続ポイントを特定し、最小限の変更で統合を目指す
   * 代替案：必要に応じて一部機能を独立モジュールとして実装

## 技術実証の成功指標
1. **実現可能性の証明**：土地図→間取り→CAD図面の一連の流れが技術的に実現可能であることを証明
2. **データフロー検証**：Google Forms→Drive→GCP→CAD→Driveの完全サイクルが機能すること
3. **処理時間の目安**：一般的なケースで10分以内に処理が完了するか、または許容可能な非同期処理方法の確立
4. **出力品質**：DXF/DWG形式で基本的な建物形状と間取りが正確に表現できること
5. **将来への指針**：本格実装に向けた明確な技術的指針と課題の特定

この技術実証ロードマップでは、既存のGoogle FormsとGoogle Driveによるデータセット管理を新システムに統合し、データ収集から処理、結果の出力まで一貫したフローを構築することを重視しています。特にFreeCADによるCAD図面生成という新たな技術要素の検証に焦点を当てながら、既存のデータ管理方法との円滑な連携を実現します。