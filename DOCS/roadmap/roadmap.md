# House Design AI プロジェクトロードマップ
## 最終更新日: 2025年5月15日

## 1. 全体目標
- 土地図から一軒家のCAD図面を自動生成するシステムの技術的実現
- 既存のYOLOv11による建物・道路セグメンテーションと、FreeCADによるCAD図面生成の統合
- 二層アーキテクチャ（HouseDiffusion生成レイヤー + CP-SAT制約ソルバーレイヤー）による間取り生成
- Google Cloud Platform（GCP）を活用したスケーラブルなシステム構築
- 将来的なYOLOv12への移行計画の策定

## 2. 現状の実装状況（2025-05-15時点）
### 2.1 完了している機能
- [x] YOLOv11による建物・道路セグメンテーション
- [x] セグメンテーション結果からの建築可能エリア計算
- [x] 基本的な間取り生成アルゴリズム
- [x] YOLOアノテーション→ベクター/グラフJSON変換システム
- [x] CP-SAT最小PoCの開発（3LDKの基本レイアウト生成と建築基準法制約の実装）
- [x] FreeCADのDockerコンテナ化と基本動作検証
- [x] Cloud Run環境でのFreeCAD実行確認
- [x] Cloud StorageでのFCStdモデル保存
- [x] StreamlitアプリケーションのDockerコンテナ化
- [x] Artifact RegistryへのDockerイメージのプッシュ
- [x] PyTorchとStreamlitの互換性問題の解決
- [x] StreamlitアプリケーションのCloud Runへのデプロイ
- [x] Terraformによるインフラストラクチャのコード化
- [x] ロゴ表示とモデルロード問題の修正
- [x] デプロイスクリプトの最適化

### 2.2 進行中の機能
- [ ] FreeCAD APIの完全実装
- [ ] Vertex AI統合の実装
- [ ] 間取り生成システムの二層アーキテクチャ実装
- [ ] 建築基準法チェック機能
- [ ] 建具記号ライブラリの作成

## 3. 今後の課題
- YOLOv12への移行による精度向上
- HouseDiffusionモデルの実装と訓練
- CP-SATによる建築基準法制約の実装
- 3Dモデルの詳細度向上
- モバイルアプリケーションの開発
- リアルタイム処理の最適化

## 4. 開発スケジュール
### フェーズ1: 環境構築（2025年4月8日〜4月15日）
- [x] 開発環境のセットアップ
- [x] FreeCADのDockerコンテナ化
- [x] 基本的なAPIエンドポイントの設計

### フェーズ2: 初期クラウド統合（2025年4月16日〜4月30日）
- [x] GCPプロジェクトのセットアップ
- [x] Terraformによるインフラ構築
- [x] Cloud RunへのFreeCAD APIデプロイ
- [x] StreamlitアプリケーションのCloud Runデプロイ

### フェーズ3: データ整備とCP-SAT PoC（2025年5月11日〜5月24日）
- [x] YOLOアノテーション→ベクター/グラフJSON変換システムの実装
- [x] CP-SAT最小PoCの開発（3LDKの基本レイアウト生成）
- [x] 910mmグリッド + 採光条件 + 階段寸法の基本制約実装
- [ ] FreeCAD APIの完全実装

### フェーズ4: HouseDiffusionモデル開発（2025年5月25日〜6月7日）
- [ ] HouseDiffusion実装・小規模データセットでの初期トレーニング
- [ ] 敷地形状と方位条件の埋め込みメカニズム実装
- [ ] FreeCAD出力基本システム構築
- [ ] YOLOv12への移行準備

### フェーズ5: 制約ソルバー完成と統合（2025年6月8日〜6月21日）
- [ ] CP-SATソルバーの完全実装
- [ ] 採光、階段、1F/2F整合性など全制約条件の実装
- [ ] Diffusionモデルと制約ソルバーの統合
- [ ] ベンチマークテスト（100案生成→制約チェック→最適化）

### フェーズ6: UI開発と最終調整（2025年6月22日〜7月5日）
- [ ] Streamlit/Three.js UIの開発
- [ ] 評価システム完成
- [ ] パフォーマンス最適化
- [ ] 実際の敷地データでのエンドツーエンドテスト
- [ ] 総合テストと品質保証
- [ ] 本番環境へのデプロイ

## 5. 優先実装項目
1. YOLOアノテーション → ベクター/グラフJSON変換システム構築
2. CP-SAT最小PoCの開発（3LDKの基本レイアウト生成）
3. FreeCAD APIの完全実装
4. HouseDiffusion実装・小規模データセットでの初期トレーニング
5. Vertex AI統合の実装
6. 建築基準法チェック機能（CP-SATによる制約実装）
7. Terraformによるデプロイプロセスの完全自動化

## 6. リスク管理
- セグメンテーション精度の不足: YOLOv12への移行とデータセット拡充で対応
- FreeCADの安定性: エラーハンドリングとリトライメカニズムの実装
- クラウドコスト: 最適化とスケーリングポリシーの設定
- 処理時間: 並列処理とキャッシュ戦略の導入
- HouseDiffusionモデルの学習不足: 小規模データセットでの事前検証とGraph2Planバックアップ戦略
- CP-SAT解の探索時間超過: ペナルティ緩和と部屋プリスナップによる決定変数削減

## 7. 成功基準
- セグメンテーション精度: IoU 0.85以上
- FreeCAD処理成功率: 95%以上
- レスポンス時間: 平均5秒以内
- クラウドコスト: 月間予算内での運用
- CP-SAT制約充足率: 建築基準法要件の100%遵守
- HouseDiffusion生成品質: 人間の建築家による評価で70%以上が「実用可能」と判断
- 1F/2F整合性: 荷重壁の垂直整合率95%以上
