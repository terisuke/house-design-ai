# 土地図からの一軒家CAD図自動生成システム 技術実証（PoC）計画書
## 2025年4月14日

## 1. 全体目標
- 土地図から一軒家のCAD図面を自動生成するシステムの技術的実現可能性を検証
- 既存のYOLOv11による建物・道路セグメンテーションと、FreeCADによるCAD図面生成の統合
- Google Cloud Platform（GCP）を活用したスケーラブルなシステム構築の実証
- 将来的なYOLOv12への移行計画の策定

## 2. 現状の実装状況（2025-04-14時点）
### 2.1 完了している機能
- [x] YOLOv11による建物・道路セグメンテーション
- [x] セグメンテーション結果からの建築可能エリア計算
- [x] 基本的な間取り生成アルゴリズム
- [x] Google Forms/Driveを活用したデータセット管理
- [x] FreeCADのDockerコンテナ化と基本動作検証
- [x] Cloud Run環境でのFreeCAD実行確認
- [x] StreamlitアプリケーションのDockerコンテナ化
- [x] Artifact RegistryへのDockerイメージのプッシュ

### 2.2 進行中の機能
- [ ] FreeCAD APIの完全実装
- [ ] StreamlitのCloud Runへのデプロイ
- [ ] Vertex AI統合の実装
- [ ] 建築基準法チェック機能
- [ ] 建具記号ライブラリの作成

### 2.3 今後の課題
- [ ] YOLOv12への移行計画の具体化
- [ ] 処理速度の最適化
- [ ] エラーハンドリングの強化
- [ ] ユーザーインターフェースの改善
- [ ] テストカバレッジの向上

## 3. 技術実証の重点項目
### 3.1 優先度の高い実装項目
1. **FreeCAD APIの完全実装**
   - 実際のFreeCAD処理の実装
   - エラーハンドリングの強化
   - パフォーマンス最適化

2. **StreamlitのGCPクラウドデプロイ**
   - Cloud RunへのStreamlitアプリケーションのデプロイ
   - ユーザーインターフェースの最適化
   - 認証・認可の実装

3. **Vertex AI統合の実装**
   - YOLOv11モデルのVertex AIへの移行
   - トレーニングパイプラインの構築
   - 推論エンドポイントの設定

### 3.2 技術的検証項目
1. **FreeCADのクラウド環境での実用性**
   - コンテナ化されたFreeCADの安定性
   - 処理速度とリソース使用効率
   - エラーハンドリングの効果

2. **既存システムと新機能の統合**
   - YOLOv11出力とFreeCAD入力の連携
   - データフローの一貫性
   - エラー伝播の制御

3. **スケーラビリティとパフォーマンス**
   - Cloud Run環境での処理能力
   - 並列処理の実現性
   - コスト効率

## 4. 開発環境とインフラ
### 4.1 開発環境
- Python 3.9+
- Docker
- Google Cloud SDK
- FreeCAD 0.21.1
- YOLOv11
- Streamlit

### 4.2 クラウドインフラ
- Google Cloud Platform
  - Cloud Run
  - Cloud Storage
  - Vertex AI
  - Cloud Build
  - IAM

### 4.3 データ管理
- Google Drive/Forms
- Cloud Storage
- BigQuery（オプション）

## 5. スケジュール
### 5.1 フェーズ1: 環境構築・基盤開発（4/8～5/5）
- [x] プロジェクト準備と環境セットアップ
- [x] Google Cloudプロジェクトのセットアップ
- [x] Google Drive/Forms連携の構築
- [x] FreeCADのDockerコンテナ化調査と初期実験

### 5.2 フェーズ2: コア機能開発第一段階（5/6～5/26）
- [x] 土地解析データ活用とFreeCAD連携
- [x] GCPサービス連携とストレージ実装
- [x] StreamlitアプリケーションのDockerコンテナ化
- [x] Artifact Registryへのイメージプッシュ

### 5.3 フェーズ3: コア機能開発第二段階（5/27～6/16）
- [ ] StreamlitアプリケーションのCloud Runデプロイ
- [ ] FreeCAD APIの完全実装
- [ ] Vertex AI統合の実装
- [ ] セグメンテーション精度向上と建築基準法チェック

### 5.4 フェーズ4: CAD図面生成とシステム統合（6/17～7/7）
- [ ] CAD図面生成機能の実装
- [ ] システム統合とテスト
- [ ] パフォーマンス最適化

### 5.5 フェーズ5: 検証と改善（7/8～7/15）
- [ ] 技術実証結果の評価
- [ ] 改善点の特定
- [ ] 将来計画の策定

## 6. リスク管理
### 6.1 技術的リスク
1. **FreeCADのクラウド環境での安定性**
   - 対策：コンテナ化とエラーハンドリングの強化
   - 代替案：ローカル処理の検討

2. **処理時間とコスト**
   - 対策：非同期処理とバッチ処理の実装
   - 代替案：処理の分割と最適化

3. **YOLOv12への移行リスク**
   - 対策：段階的な移行計画
   - 代替案：YOLOv11の継続使用

### 6.2 プロジェクトリスク
1. **チーム規模（2名）に対するタスク量**
   - 対策：優先順位の明確化
   - 代替案：外部リソースの活用

2. **スケジュールの遅延**
   - 対策：アジャイル開発手法の採用
   - 代替案：スコープの調整

## 7. 成功基準
### 7.1 技術的基準
1. FreeCADによる基本的なCAD図面生成が可能
2. Cloud Run環境での安定した動作
3. 処理時間が許容範囲内（10分以内）

### 7.2 プロジェクト基準
1. 主要機能の実装完了
2. 基本的なエラーハンドリングの実装
3. 将来計画の具体化

## 8. 将来計画：YOLOv12への移行
### 8.1 移行の目的
1. アテンション機能の活用
2. 間取り画像認識機能の追加
3. 処理速度と精度の向上

### 8.2 移行準備（2025年7月～9月）
1. YOLOv12の調査と評価
2. データセットの拡充
3. 移行計画の詳細化

## 9. まとめ
この技術実証計画では、既存のYOLOv11システムとFreeCADを統合し、Google Cloud Platformを活用したスケーラブルなシステムの構築を目指します。特にFreeCADのクラウド環境での実用性、既存システムとの統合可能性、および将来的なYOLOv12への移行計画に焦点を当てています。技術的なリスクを適切に管理しながら、実現可能性の検証と将来への指針の確立を目指します。 