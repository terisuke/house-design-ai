# 土地図からの一軒家CAD図自動生成システム 技術実証（PoC）開発ロードマップ
## 2025年4月8日～2025年7月15日

## フェーズ1: 環境構築・基盤開発と初期クラウド統合（4月8日～5月5日）
### 週1-2（4/8～4/21）：プロジェクト準備と環境セットアップ
- [x] 技術実証の詳細計画確定と成功基準の設定
- [x] Google Cloudプロジェクトのセットアップ
  - GCPプロジェクト作成と基本設定
  - 必要なAPIの有効化（Cloud Storage, Cloud Run, Vertex AI等）
  - IAM権限の初期設定
- [x] **Google Drive/Forms連携の構築**
  - 既存のGoogle Form/Driveからのデータ取得方法の分析
  - Google Cloud環境へのデータ連携方法の設計
  - APIアクセス権限の設定
- [x] 開発環境のセットアップ
- [x] **FreeCADのDockerコンテナ化調査と初期実験**（★技術的難易度高）
  - FreeCADヘッドレスモードの実行可能性検証
  - 基本的なPython APIの調査と簡易テスト

### 週3-4（4/22～5/5）：フロントエンド初期実装とFreeCAD基盤
- [x] 既存Streamlitアプリへの新機能追加準備
  - CAD生成に必要なUI要素の設計
  - 既存コードとの連携ポイント特定
- [x] **Google Drive連携モジュールの実装**
  - Google Drive APIを使用したファイル取得機能
  - データセット管理のための自動化スクリプト
  - Forms-Drive-GCPの連携フロー構築
- [x] Cloud Runへの初期デプロイ
  - CI/CDパイプラインの構築
  - 自動ビルド・デプロイの設定
- [x] **FreeCADのDockerコンテナ化と基本動作検証**（継続）
  - コンテナ内での安定動作確認
  - 基本的なPython API呼び出しのテスト
  - クラウド環境での動作確認

## フェーズ2: コア機能開発第一段階（5月6日～5月26日）
### 週5-6（5/6～5/19）：土地解析データ活用とFreeCAD連携
- [x] 既存YOLOv11出力データの分析と拡張活用
  - 既存セグメンテーション結果からCAD生成に必要なデータの抽出
  - 建築可能エリア計算への応用
- [x] **Google Forms/Driveデータの統合と活用**
  - データセットの自動インポート機能
  - メタデータと画像データの関連付け
  - データの前処理パイプライン構築
- [x] **FreeCAD連携モジュールの基本実装**（★技術的難易度高）
  - シンプルな形状生成スクリプトの作成
  - FreeCADとPython間の通信確立
  - 初期テストケースの実行

### 週7（5/20～5/26）：GCPサービス連携とストレージ実装
// ... existing code ...

## フェーズ3: コア機能開発第二段階（5月27日～6月16日）
### 週8-9（5/27～6/9）：FreeCAD APIの完全実装とStreamlit統合
- [ ] **FreeCAD APIの完全実装**（★優先度高）
  - 実際のFreeCAD処理の実装
  - エラーハンドリングの強化
  - パフォーマンス最適化
- [ ] **StreamlitのGCPクラウドデプロイ**（★優先度高）
  - Cloud RunへのStreamlitアプリケーションのデプロイ
  - ユーザーインターフェースの最適化
  - 認証・認可の実装
- [ ] **Vertex AI統合の実装**（★優先度高）
  - YOLOv11モデルのVertex AIへの移行
  - トレーニングパイプラインの構築
  - 推論エンドポイントの設定

### 週10（6/10～6/16）：セグメンテーション精度向上と建築基準法チェック
- [ ] **セグメンテーション精度の向上**（★優先度高）
  - データセットの拡充
  - モデルの再トレーニング
  - 評価指標の改善
- [ ] **建築基準法チェック機能の実装**（★優先度高）
  - 建蔽率・容積率チェック
  - 日影規制チェック
  - 高さ制限チェック
- [ ] **建具記号ライブラリの作成**
  - ドア記号ライブラリ
  - 窓記号ライブラリ
  - カスタマイズ機能

## フェーズ4: CAD図面生成とシステム統合（6月17日～7月7日）
// ... existing code ...

## 技術実証の重点領域
### 優先すべき検証項目
1. **FreeCADのクラウド環境での実用性**：✅ 最も大きな技術的リスク要素を解決
2. **既存YOLOv11システムとFreeCADの統合可能性**：✅ 核心的な検証ポイントを達成
3. **CAD図面生成の自動化レベル**：🟡 基本的な機能は実装済み、品質向上が必要
4. **Google Forms/Drive連携の効率性**：✅ データ収集から結果出力までの一貫した流れを実現
5. **GCP環境でのパフォーマンスと安定性**：✅ スケーラブルなシステムとして機能を確認

### 削減可能な検証範囲（時間制約の場合）
1. **複雑な建築法規制の実装**：🟡 基本的な建蔽率・道路斜線のみで技術実証
2. **高度な間取り最適化**：🟡 既存システムの間取り生成機能を最大限活用
3. **詳細なCAD図面の装飾**：🟡 基本的な壁・開口部のみで技術的実現性を証明
4. **Google Driveの高度な権限管理**：✅ 基本的なアクセス制御のみを実装
5. **多様なケースでの検証**：🟡 代表的な2-3パターンの土地図で技術実証を完了

## 将来計画：YOLOv12への移行
### 移行の目的
1. **アテンション機能の活用**
   - より正確な建物・道路セグメンテーション
   - 複雑な形状の認識精度向上
   - ノイズに対する耐性強化

2. **間取り画像認識機能の追加**
   - 既存の間取り図からの情報抽出
   - 部屋配置パターンの学習
   - 間取り最適化のためのデータ収集

3. **処理速度と精度の向上**
   - アテンション機構による効率的な特徴抽出
   - 軽量モデルアーキテクチャの活用
   - エッジデバイスでの実行可能性

### 移行準備（2025年7月～9月）
1. **YOLOv12の調査と評価**
   - アテンション機能の詳細分析
   - 既存システムとの互換性確認
   - パフォーマンス比較テスト

2. **データセットの拡充**
   - 間取り画像データの収集
   - アノテーション作業の計画
   - データ拡張手法の検討

3. **移行計画の詳細化**
   - 段階的な移行スケジュール
   - テスト環境の構築
   - 評価指標の設定

## 開発進捗管理
* 週次のスプリントで計画と振り返りを実施
* 高難度タスク（特にFreeCAD関連）の早期開始と継続的な取り組み
* Cloud Run環境への定期的デプロイを通じた進捗の可視化
* 主要な技術的ハードルごとの検証結果の文書化
* Google Sheetsを活用した進捗追跡とタスク管理

## リスク管理
### 主要リスクと対策
1. **FreeCADのクラウド環境での安定性と性能**（✅ 解決）
   * 対策：Cloud Runでの安定動作を確認
   * 代替案：不要（問題解決済み）

2. **Google Drive API制限とパフォーマンス**（✅ 解決）
   * 対策：API呼び出し頻度の最適化、バッチ処理の実装
   * 代替案：不要（問題解決済み）

3. **処理時間の長さとクラウドコスト**（🟡 進行中）
   * 対策：非同期処理の実装、処理の分割と最適化
   * 代替案：技術実証段階では処理時間より機能の実現性を優先

4. **チーム規模（2名）に対するタスク量**（🟡 進行中）
   * 対策：技術実証の範囲を明確に絞り込み、核心的な検証項目に集中
   * 代替案：外部サービスやライブラリの活用で自前実装を減らす

5. **既存システムと新機能の統合の複雑さ**（🟡 進行中）
   * 対策：明確な接続ポイントを特定し、最小限の変更で統合を目指す
   * 代替案：必要に応じて一部機能を独立モジュールとして実装

6. **YOLOv12への移行リスク**（🟡 計画中）
   * 対策：段階的な移行計画、十分なテスト環境の準備
   * 代替案：YOLOv11を継続使用し、部分的にYOLOv12機能を統合

## 技術実証の成功指標
1. **実現可能性の証明**：🟡 土地図→間取り→CAD図面の一連の流れが技術的に実現可能であることを証明
2. **データフロー検証**：✅ Google Forms→Drive→GCP→CAD→Driveの完全サイクルが機能すること
3. **処理時間の目安**：🟡 一般的なケースで10分以内に処理が完了するか、または許容可能な非同期処理方法の確立
4. **出力品質**：🟡 DXF/DWG形式で基本的な建物形状と間取りが正確に表現できること
5. **将来への指針**：🟡 本格実装に向けた明確な技術的指針と課題の特定、YOLOv12への移行計画の具体化

この技術実証ロードマップでは、既存のGoogle FormsとGoogle Driveによるデータセット管理を新システムに統合し、データ収集から処理、結果の出力まで一貫したフローを構築することを重視しています。特にFreeCADによるCAD図面生成という新たな技術要素の検証に焦点を当てながら、既存のデータ管理方法との円滑な連携を実現します。また、将来的にはYOLOv12への移行を計画しており、アテンション機能を活用した間取り画像認識機能の追加を検討しています。 